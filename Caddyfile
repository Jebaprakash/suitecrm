{
    frankenphp
    admin off
}

:{$PORT:8080} {
    # Force IPv4 binding for Railway compatibility
    bind 0.0.0.0
    
    root * /app/public
    encode zstd gzip

    # Static files first
    file_server

    # Handle PHP files
    php_server

    # Standard Symfony/SuiteCRM 8 routing fallback
    @notStatic {
        not file {path}
    }
    rewrite @notStatic /index.php?{query}

    # Enable detailed logs for debugging in Railway dashboard
    log {
        output stdout
    }
}
